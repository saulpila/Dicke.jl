<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>EnergyShellProjections · DickeModel.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/customcss.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DickeModel.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">DickeModel.jl</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ClassicalDickeExamples/">ClassicalDicke</a></li><li><a class="tocitem" href="../DickeBCEExamples/">DickeBCE (Quantum Dicke)</a></li><li><a class="tocitem" href="../EnergyShellProjectionsExamples/">EnergyShellProjections</a></li><li><a class="tocitem" href="../TWAExamples/">TWA</a></li><li><a class="tocitem" href="../UPOsExamples/">UPOs</a></li><li><a class="tocitem" href="../ClassicalLMGExamples/">ClassicalLMG</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../ClassicalDicke/">ClassicalDicke</a></li><li><a class="tocitem" href="../DickeBCE/">DickeBCE</a></li><li class="is-active"><a class="tocitem" href>EnergyShellProjections</a><ul class="internal"><li><a class="tocitem" href="#Integrals-of-arbitrary-functions"><span>Integrals of arbitrary functions</span></a></li><li><a class="tocitem" href="#Integrals-of-Husimi-functions"><span>Integrals of Husimi functions</span></a></li></ul></li><li><a class="tocitem" href="../TWA/">TWA</a></li><li><a class="tocitem" href="../UPOs/">UPOs</a></li><li><a class="tocitem" href="../ClassicalLMG/">ClassicalLMG</a></li><li><a class="tocitem" href="../ClassicalSystems/">ClassicalSystems</a></li><li><a class="tocitem" href="../PhaseSpaces/">PhaseSpaces</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li class="is-active"><a href>EnergyShellProjections</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>EnergyShellProjections</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/saulpila/DickeModel.jl/blob/master/docs/src/EnergyShellProjections.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DickeModel.EnergyShellProjections"><a class="docs-heading-anchor" href="#DickeModel.EnergyShellProjections">DickeModel.EnergyShellProjections</a><a id="DickeModel.EnergyShellProjections-1"></a><a class="docs-heading-anchor-permalink" href="#DickeModel.EnergyShellProjections" title="Permalink"></a></h1><p>For examples of usage, go to  <a href="../EnergyShellProjectionsExamples/#Examples-for-EnergyShellProjections">Examples for EnergyShellProjections</a>.</p><h2 id="Integrals-of-arbitrary-functions"><a class="docs-heading-anchor" href="#Integrals-of-arbitrary-functions">Integrals of arbitrary functions</a><a id="Integrals-of-arbitrary-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Integrals-of-arbitrary-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DickeModel.EnergyShellProjections.∫∫dqdpδϵ" href="#DickeModel.EnergyShellProjections.∫∫dqdpδϵ"><code>DickeModel.EnergyShellProjections.∫∫dqdpδϵ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function ∫∫dqdpδϵ(system::DickeSystem;
    ϵ::Real,
    Q::Real,
    P::Real,
    f::Function,
    p_res::Real=0.01,
    nonvalue=nothing,
    onlyqroot::Union{typeof(-),typeof(+),Nothing}=nothing)</code></pre><p>Computes the integral  </p><p class="math-container">\[    \int \int \text{d}q \text{d}p f(\mathbf{x}) \delta(h_\text{cl}(\mathbf{x}) - \epsilon)\]</p><p>using Eq. (8) of Ref. <a href="../references/#Pilatowsky2021NatCommun">[14]</a> and a  <a href="https://en.wikipedia.org/wiki/Chebyshev%E2%80%93Gauss_quadrature">Chebyshev–Gauss quadrature</a> method.  </p><p>Note: to type <code>∫</code> in Julia, type <code>\int</code> + Tab.</p><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalDicke/#DickeModel.ClassicalDicke.DickeSystem"><code>ClassicalDicke.DickeSystem</code></a>.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>ϵ</code> is a real number corresponding to <span>$\epsilon$</span> above.</li><li><code>Q</code> and <code>P</code> are the <span>$Q$</span> and <span>$P$</span> coordinates of <span>$\mathbf{x}$</span> above.</li><li><code>f</code> should be function with signature <code>f([Q,q,P,p])</code> that returns values that may be added together (e.g. numbers, arrays, etc...).</li><li><code>p_res</code> is the resolution of the integral. The amount of nodes for the quadrature will be equal to <code>2*floor(p₊/p_res) + 1</code>, where <code>p₊</code> is defined below Eq. (9) of Ref. <a href="../references/#Pilatowsky2021NatCommun">[14]</a>. Default is <code>0.01</code>.</li><li><code>nonvalue</code> is the value to return if <span>$Q,P$</span> are outside of the energy shell at <span>$\epsilon$</span>. Default is <code>NaN</code>.</li><li><code>onlyqroot</code> may be <code>+</code>, <code>-</code>, or <code>nothing</code> (default). If it is <code>+</code> (<code>-</code>), the integral is only computed over the positive (negative) roots in <code>q</code>, that is, only the <span>$q_+$</span> (<span>$q_-$</span>) term is taken in Eq. (8) of Ref. <a href="../references/#Pilatowsky2021NatCommun">[14]</a>. If it is <code>nothing</code>, both terms are added.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/DickeModel.jl/blob/8670fdce9102d657d5e4168866e2ded8d731ee6b/src/EnergyShellProjections.jl#L12-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DickeModel.EnergyShellProjections.matrix_QP∫∫dqdpδϵ" href="#DickeModel.EnergyShellProjections.matrix_QP∫∫dqdpδϵ"><code>DickeModel.EnergyShellProjections.matrix_QP∫∫dqdpδϵ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function matrix_QP∫∫dqdpδϵ(system::DickeSystem;
    f::Function,
    ϵ::Real,
    res::Real=0.1,
    symmetricQP::Bool=false,
    symmetricP::Bool=symmetricQP,
    parallelize::Bool=(Distributed.myid()==1),
    show_progress::Bool = true,
    pbatch_size::Integer=Int(min(ceil((4/res)^2/Distributed.nprocs()/10),50)))</code></pre><p>Returns  a tuple <code>(Qs, Ps, mat)</code> where <code>Qs</code> and <code>Ps</code> are real vectors spanning all possible values of <span>$P$</span> and <span>$Q$</span> with some step <code>res</code>, and <code>mat</code>  is a matrix whose entries are given by <code>mat[i,j] =</code><a href="#DickeModel.EnergyShellProjections.∫∫dqdpδϵ"><code>∫∫dqdpδϵ(system; kargs..., ϵ=ϵ, Q=Qs[i], P=P[j], p_res=res)</code></a></p><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalDicke/#DickeModel.ClassicalDicke.DickeSystem"><code>ClassicalDicke.DickeSystem</code></a>.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>ϵ</code> is a real number (see arguments for <a href="#DickeModel.EnergyShellProjections.∫∫dqdpδϵ"><code>∫∫dqdpδϵ</code></a>).</li><li><code>f</code> should be function with signature <code>f([Q,q,P,p])</code> that returns values that may be added together (e.g. numbers, arrays, etc...).</li><li><code>res</code> determines the separation between the elements of <code>Qs</code> and <code>Ps</code>. It also determines <code>p_res</code> in the calls to <a href="#DickeModel.EnergyShellProjections.∫∫dqdpδϵ"><code>∫∫dqdpδϵ</code></a>. It should be a positive real number that is an integer fraction of 2 (i.e. <span>$2/n$</span> for some <span>$n \in \mathbb{N}$</span>). Computation time is inversely proportional to the cube of this quantity.</li><li>If <code>symmetricQP</code> is <code>true</code>, only the non-positive entries of <code>Q</code> and <code>P</code> will be computed,  and the other entries will be mirrored. Default is <code>false</code>.</li><li>If <code>symmetricP</code> is <code>true</code>, only the side with  non-positive <code>P</code> coordinate will be comptued, and the other entries will be mirrored. The default is to  be the same that <code>symmetricQP</code>.</li><li><code>parallelize</code> indicates whether to use all available workers. Defaults to <code>true</code> if this function is called  from worker <code>1</code>, and <code>false</code> else.</li><li><code>show_progress</code> turns the progress bar on/off. Default is <code>true</code>.</li><li><code>pbatch_size</code> is the maximum number of batches to run in a single run in a single worker. The default value is automatically optimized depending on <code>res</code> and the number of workers.</li><li><code>kargs...</code> are redirected to <a href="#DickeModel.EnergyShellProjections.∫∫dqdpδϵ"><code>∫∫dqdpδϵ</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/DickeModel.jl/blob/8670fdce9102d657d5e4168866e2ded8d731ee6b/src/EnergyShellProjections.jl#L120-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DickeModel.EnergyShellProjections.energy_shell_average" href="#DickeModel.EnergyShellProjections.energy_shell_average"><code>DickeModel.EnergyShellProjections.energy_shell_average</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function energy_shell_average(system::DickeSystem;
    ϵ::Real,
    f::Function,
    res::Real=0.01,
    symmetricQP::Bool=false,
    symmetricP::Bool=symmetricQ)</code></pre><p>Returns the energy shell average</p><p class="math-container">\[\frac{j^2}{(2\pi)^2\nu(\epsilon)}\int_{\mathcal{M}}\!\!\text{d}\mathbf{x}\,  \delta(h_\text{cl}(\mathbf{x})-\epsilon) f(\mathbf{x})\]</p><p>of <code>f([Q,q,P,p])</code>.</p><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalDicke/#DickeModel.ClassicalDicke.DickeSystem"><code>ClassicalDicke.DickeSystem</code></a>.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>ϵ</code> is a real number</li><li><code>f</code> should be function with signature <code>f([Q,q,P,p])</code> that returns values that may be added together (e.g. numbers, arrays, etc...).</li><li><code>res</code> determines the separation between the elements of <code>Qs</code> and <code>Ps</code>. It also determines <code>p_res</code> in the calls to <a href="#DickeModel.EnergyShellProjections.∫∫dqdpδϵ"><code>∫∫dqdpδϵ</code></a>. It should be a positive real number that is an integer fraction of 2 (i.e. <span>$2/n$</span> for some <span>$n \in \mathbb{N}$</span>). Computation time is inversely proportional to the cube of this quantity.</li><li>If <code>symmetricQP</code> is <code>true</code>, only the non-positive entries of <code>Q</code> and <code>P</code> will be computed,  and the other entries will be mirrored. Default is <code>false</code>.</li><li>If <code>symmetricP</code> is <code>true</code>, only the side with  non-positive <code>P</code> coordinate will be comptued, and the other entries will be mirrored. The default is to  be the same that <code>symmetricQP</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/DickeModel.jl/blob/8670fdce9102d657d5e4168866e2ded8d731ee6b/src/EnergyShellProjections.jl#L445-L475">source</a></section></article><h2 id="Integrals-of-Husimi-functions"><a class="docs-heading-anchor" href="#Integrals-of-Husimi-functions">Integrals of Husimi functions</a><a id="Integrals-of-Husimi-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Integrals-of-Husimi-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DickeModel.EnergyShellProjections.rényi_occupation_and_proj_husimi_QP_matrix" href="#DickeModel.EnergyShellProjections.rényi_occupation_and_proj_husimi_QP_matrix"><code>DickeModel.EnergyShellProjections.rényi_occupation_and_proj_husimi_QP_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function rényi_occupation_and_proj_husimi_QP_matrix(system::DickeBCE.QuantumDickeSystem,
    states::AbstractVecOrMat{&lt;:Number};
    res::Real,
    chop::Real=1e-4,
    nonvalue=NaN,
    mix_states::Bool=false,
    mix_function::Function=mean,
    α::Union{AbstractArray{&lt;:Real,1},Real}=2,
    matrix_powers::Union{AbstractArray{&lt;:Real,1},Real}=1,
    kargs...)</code></pre><p>Returns a tuple <code>(Ls,(Qs,Ps,matrices))</code> where <code>Ls</code> contains the Rényi occupations given by Eq. (30) of Ref. <a href="../references/#Villasenor2021">[20]</a>, and <code>matrices</code> contains  the values of the projections</p><p class="math-container">\[    \iint \text{d} q\text{d} p \,\delta(h_\text{cl}(Q,q,P,p)-\epsilon)\, \mathcal{Q}_{\psi}(Q,q,P,p)^\alpha,\]</p><p>where <span>$\mathcal{Q}_{\psi}(\mathbf{x}) = \left | \left \langle \mathbf{x}  \middle | \psi \right \rangle \right |^2$</span>  is the Husimi function of state <span>$\left | \psi \right \rangle$</span>, for each <span>$Q$</span> in <code>Qs</code> and <span>$P$</span> in <code>Ps</code>. The values <span>$\alpha$</span> in <code>α</code> (which may be a vector or a number) determine the order of the Rényi occupations, and <code>matrix_powers</code> determine the powers of the projections. </p><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../DickeBCE/#DickeModel.DickeBCE.QuantumDickeSystem"><code>DickeBCE.QuantumDickeSystem</code></a>.</li><li><code>states</code> may be a vector (single state) or a matrix of multiple states as columns.  The states are assummed to be in the efficient coherent basis. In the special case that the length of the states is 4, they are instead assumed to be the coordinates <code>[Q,q,P,p]</code> of a coherent state, and <a href="../DickeBCE/#DickeModel.DickeBCE.husimi_of_coherent"><code>husimi_of_coherent</code></a> is used. </li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>ϵ</code>, <code>Q</code>, and <code>P</code> (which are <span>$\epsilon$</span>, <span>$Q$</span>, and <span>$P$</span> above) have to be passed.</li><li><code>chop</code> is passed to <a href="../DickeBCE/#DickeModel.DickeBCE.coherent_overlap"><code>DickeBCE.coherent_overlap</code></a>.</li><li><code>res</code> determines the resolution of the integral, as in <a href="#DickeModel.EnergyShellProjections.matrix_QP∫∫dqdpδϵ"><code>matrix_QP∫∫dqdpδϵ</code></a>.</li><li><code>nonvalue</code> is the value to return if <span>$Q,P$</span> are outside of the energy shell at <span>$\epsilon$</span>. Default is <code>NaN</code>.</li><li><code>mix_states</code> switches the behaviour if <code>states</code> is a matrix. If <code>false</code> (default), a result is returned for each state. If <code>true</code>, the Husimis are first passed to <code>mix_function</code>, and the result is integrated.  </li><li><code>mix_function</code> – when <code>mix_states</code> is <code>true</code>, this function is evaluated with the resulting Husimis <code>mix_function([Qstate1,Qstate2, ...])</code> before manipulating them. Each number <code>Qstatei</code> corresponds to the Husimi function of the <code>i</code>th column of <code>states</code>.  The default function is <code>mean</code>, which is equivalent to treating the matrix <code>states</code> as a mixed state with equal weights. Custom weights could be used by passing <code>mix_function([Qstate1,Qstate2, ...]) = p1*Qstate1 + p2*Qstate2 + ...</code>. Moreover, <code>mix_function</code> may return a vector: for example, <code>mix_function([Qstate1,Qstate2, ...]) = [Qstate1, (Qstate1 + Qstate2)/2]</code> would compute <code>Ls</code> and <code>matrices</code> for two states: first for <code>state1</code>, and second the mixed state composed of half <code>state1</code> and half <code>state2</code>. This allows to compute several quantities in one run. Another example, <code>mix_function(hus) = [hus; mean(hus)]</code> will compute all the individual states, along with the equally-weighted mixed state.</li><li><code>α</code> may be a number or an array, determining the orders of the Rényi occupations <code>Ls</code>. Defaults to <code>2</code>.</li><li><code>matrix_powers</code> may be a number or an array, determining the orders of the moments in the projections matrices. <code>matrix_powers</code>  should be a subset of <code>α ∪ {1}</code>. Defaults to <code>1</code>.</li><li><code>kargs</code> are redirected to <a href="#DickeModel.EnergyShellProjections.matrix_QP∫∫dqdpδϵ"><code>matrix_QP∫∫dqdpδϵ</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/DickeModel.jl/blob/8670fdce9102d657d5e4168866e2ded8d731ee6b/src/EnergyShellProjections.jl#L259-L310">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DickeModel.EnergyShellProjections.rényi_occupation" href="#DickeModel.EnergyShellProjections.rényi_occupation"><code>DickeModel.EnergyShellProjections.rényi_occupation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function rényi_occupation</code></pre><p>Returns only the Rényi occupations <code>Ls</code> in <a href="#DickeModel.EnergyShellProjections.rényi_occupation_and_proj_husimi_QP_matrix"><code>rényi_occupation_and_proj_husimi_QP_matrix</code></a>, same arguments apply, although <code>matrix_powers</code> is ignored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/DickeModel.jl/blob/8670fdce9102d657d5e4168866e2ded8d731ee6b/src/EnergyShellProjections.jl#L422-L427">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DickeModel.EnergyShellProjections.proj_husimi_QP_matrix" href="#DickeModel.EnergyShellProjections.proj_husimi_QP_matrix"><code>DickeModel.EnergyShellProjections.proj_husimi_QP_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function proj_husimi_QP_matrix</code></pre><p>Returns only the projection matrices <code>(Qs,Ps,matrices)</code> in <a href="#DickeModel.EnergyShellProjections.rényi_occupation_and_proj_husimi_QP_matrix"><code>rényi_occupation_and_proj_husimi_QP_matrix</code></a>, same arguments apply, although <code>α</code> should not be passed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/DickeModel.jl/blob/8670fdce9102d657d5e4168866e2ded8d731ee6b/src/EnergyShellProjections.jl#L432-L437">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../DickeBCE/">« DickeBCE</a><a class="docs-footer-nextpage" href="../TWA/">TWA »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.4 on <span class="colophon-date" title="Thursday 22 July 2021 18:17">Thursday 22 July 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
