<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TruncatedWignerApproximation · Dicke.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/customcss.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Dicke.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">The Dicke.jl package</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ClassicalDickeExamples/">Classical Dicke</a></li><li><a class="tocitem" href="../TruncatedWignerApproximationExamples/">Truncated Wigner Approximation</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../ClassicalDicke/">ClassicalDicke</a></li><li><a class="tocitem" href="../ClassicalSystems/">ClassicalSystems</a></li><li><a class="tocitem" href="../DickeBCE/">DickeBCE</a></li><li><a class="tocitem" href="../UPOS/">UPOS</a></li><li class="is-active"><a class="tocitem" href>TruncatedWignerApproximation</a><ul class="internal"><li><a class="tocitem" href="#Dicke.TruncatedWignerApproximation.Weyl"><span>Weyl symbols</span></a></li></ul></li><li><a class="tocitem" href="../DickeHusimiProjections/">DickeHusimiProjections</a></li><li><a class="tocitem" href="../ClassicalLMG/">ClassicalLMG</a></li><li><a class="tocitem" href="../PhaseSpaces/">PhaseSpaces</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li class="is-active"><a href>TruncatedWignerApproximation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>TruncatedWignerApproximation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/saulpila/Dicke.jl/blob/master/docs/src/TruncatedWignerApproximation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Dicke.TruncatedWignerApproximation"><a class="docs-heading-anchor" href="#Dicke.TruncatedWignerApproximation">Dicke.TruncatedWignerApproximation</a><a id="Dicke.TruncatedWignerApproximation-1"></a><a class="docs-heading-anchor-permalink" href="#Dicke.TruncatedWignerApproximation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.MonteCarloSystem" href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>Dicke.TruncatedWignerApproximation.MonteCarloSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct MonteCarloSystem</code></pre><p>This object may be passed to <a href="#Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}"><code>monte_carlo_integrate</code></a>. Use <a href="#Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_averaging</code></a>,  <a href="#Dicke.TruncatedWignerApproximation.mcs_for_variance-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_variance</code></a>, and <a href="#Dicke.TruncatedWignerApproximation.mcs_for_survival_probability-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_survival_probability</code></a> to generate them,  and <a href="#Dicke.TruncatedWignerApproximation.mcs_chain-Tuple{AbstractVector{Dicke.TruncatedWignerApproximation.MonteCarloSystem}}"><code>mcs_chain</code></a> to join them together.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L26-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution" href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct PhaseSpaceDistribution</code></pre><p>This object represents a probability distribution in the phase space. Currently, the only  implementation is through <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2-Tuple{AbstractVector{var&quot;#s142&quot;} where var&quot;#s142&quot;&lt;:Real}"><code>coherent_Wigner_HWxSU2</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L14-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.average-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.average-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.average</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function average(system::ClassicalSystems.ClassicalSystem, 
    [[[same kargs as mcs_for_averaging]]],
    kargs...)</code></pre><p>Calls <a href="#Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_averaging</code></a> and then <a href="#Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}"><code>monte_carlo_integrate</code></a> on the resulting <code>MonteCarloSystem</code>. Extra <code>kargs</code> are sent to the latter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L545-L552">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.calculate_distribution-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.calculate_distribution-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.calculate_distribution</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function calculate_distribution(system::ClassicalSystems.ClassicalSystem, 
    [[[same kargs as mcs_for_distributions]]],
    kargs...)</code></pre><p>Calls <a href="#Dicke.TruncatedWignerApproximation.mcs_for_distributions-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_distributions</code></a> and then <a href="#Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}"><code>monte_carlo_integrate</code></a> on the resulting <code>MonteCarloSystem</code>. Extra <code>kargs</code> are sent to the latter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L532-L539">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{Any}" href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{Any}"><code>Dicke.TruncatedWignerApproximation.coherent_Wigner_HW</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function  coherent_Wigner_HW(u₀::AbstractVector{&lt;:Real},j::Real=1,ħ::Real=1/j)</code></pre><p>Same as <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{}"><code>coherent_Wigner_HW</code></a>, taking <code>u₀ = [q₀, p₀]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L766-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{}" href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{}"><code>Dicke.TruncatedWignerApproximation.coherent_Wigner_HW</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function coherent_Wigner_HW(;q₀::Real,p₀::Real,j::Real=1,ħ::Real=1/j)</code></pre><p>Returns a <a href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>PhaseSpaceDistribution</code></a> corresponding to the two-dimensional Wigner function of a coherent state of the Heisenberg-Weyl algebra (i.e. a standard coherent state)  centered at <code>q₀,p₀</code>. A value of <code>ħ</code> may be passed, or pass <code>j</code> to set <code>ħ = 1/j</code>. (See Eq. (B.1) of Ref. <a href="../references/#Villasenor2020">[9]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L668-L675">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2-Tuple{AbstractVector{var&quot;#s142&quot;} where var&quot;#s142&quot;&lt;:Real}" href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2-Tuple{AbstractVector{var&quot;#s142&quot;} where var&quot;#s142&quot;&lt;:Real}"><code>Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function  coherent_Wigner_HWxSU2(u₀::AbstractVector{&lt;:Real},j::Real=1,ħ::Real=1/j)</code></pre><p>Same as <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2-Tuple{}"><code>coherent_Wigner_HWxSU2</code></a>, taking <code>u₀ = [Q₀, q₀, P₀, p₀]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L750-L755">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2-Tuple{}" href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2-Tuple{}"><code>Dicke.TruncatedWignerApproximation.coherent_Wigner_HWxSU2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function coherent_Wigner_HWxSU2(;Q₀::Real,q₀::Real,P₀::Real,p₀::Real,j::Real=1,ħ::Real=1/j)</code></pre><p>Produces the Wigner function corresponding to the tensor product of <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{Any}"><code>coherent_Wigner_HW</code></a> and <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2-Tuple{Any}"><code>coherent_Wigner_SU2</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L733-L738">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2-Tuple{Any}" href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2-Tuple{Any}"><code>Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function  coherent_Wigner_SU2(u₀::AbstractVector{&lt;:Real},j::Real=1,ħ::Real=1/j)</code></pre><p>Same as <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2-Tuple{}"><code>coherent_Wigner_SU2</code></a>, taking <code>u₀ = [Q₀, P₀]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L758-L763">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2-Tuple{}" href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2-Tuple{}"><code>Dicke.TruncatedWignerApproximation.coherent_Wigner_SU2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function coherent_Wigner_HW(;Q₀::Real,P₀::Real,j::Real=1,ħ::Real=1/j)</code></pre><p>Same as <a href="#Dicke.TruncatedWignerApproximation.coherent_Wigner_HW-Tuple{Any}"><code>coherent_Wigner_HW</code></a>, but for a coherent state for the SU(2)  algebra (a Bloch coherent state).  The approximation given by Eq. (B.4) of Ref. <a href="../references/#Villasenor2020">[9]</a> is used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L688-L694">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.mcs_chain-Tuple{AbstractVector{Dicke.TruncatedWignerApproximation.MonteCarloSystem}}" href="#Dicke.TruncatedWignerApproximation.mcs_chain-Tuple{AbstractVector{Dicke.TruncatedWignerApproximation.MonteCarloSystem}}"><code>Dicke.TruncatedWignerApproximation.mcs_chain</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function mcs_chain(Fs::AbstractArray{MonteCarloSystem,1})</code></pre><p>Generates a <a href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>MonteCarloSystem</code></a> by chaining together those in the array <code>Fs = [monteCarloSystem1, monteCarloSystem2, ...]</code>. The output of the system generated is an array that has the outputs of each system, in the same order as <code>Fs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L230-L236">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.mcs_chain-Union{Tuple{Vararg{Dicke.TruncatedWignerApproximation.MonteCarloSystem, N}}, Tuple{N}} where N" href="#Dicke.TruncatedWignerApproximation.mcs_chain-Union{Tuple{Vararg{Dicke.TruncatedWignerApproximation.MonteCarloSystem, N}}, Tuple{N}} where N"><code>Dicke.TruncatedWignerApproximation.mcs_chain</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function mcs_chain(mcs1::MonteCarloSystem, mcs2::MonteCarloSystem, ...)</code></pre><p>Functionally equivalent to <a href="#Dicke.TruncatedWignerApproximation.mcs_chain-Tuple{AbstractVector{Dicke.TruncatedWignerApproximation.MonteCarloSystem}}"><code>mcs_chain</code></a><code>([mcs1, mcs2, ...])</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L218-L223">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.mcs_for_averaging</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function mcs_for_averaging(
    system::ClassicalSystems.ClassicalSystem;
    observable,
    ts::AbstractVector{&lt;:Real}=[0.0],
    N::Integer,
    distribution::PhaseSpaceDistribution)</code></pre><p>Generates a <a href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>MonteCarloSystem</code></a> that computes</p><p class="math-container">\[    \frac{1}{N} \sum_{i=1}^N \text{observable}(\mathbf{x}_i(t))\]</p><p>for each <span>$t$</span> in <code>ts</code>, where <span>$\mathbf{x}_i$</span> will be sampled from <code>distribution</code>. The system produces an array the same size as <code>ts</code>, containing the result for each time.</p><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalSystems/#Dicke.ClassicalSystems.ClassicalSystem"><code>ClassicalSystems.ClassicalSystem</code></a>,</li><li><code>observable</code> can a function in the form <code>f(x::Vector)</code> or <code>f(x1,x2 ,..., x_n)</code> with  n the dimension of the phase space determined by <code>system</code>. <code>observable</code> can also be an expression determining the operations between the <code>varnames</code> determined by system. For example, if <code>system</code> were a instance of <a href="../ClassicalDicke/#Dicke.ClassicalDicke.ClassicalDickeSystem"><code>ClassicalDicke.ClassicalDickeSystem</code></a>, then <code>observable</code> could be <code>:(q+p^2 +Q)</code>, <code>f(Q, q, P, p) = q + p^2 - Q</code> or <code>f(x) = x[2] + x[4]^2 - x[1]</code>, which are all equivalent. See also the submodule <a href="#Dicke.TruncatedWignerApproximation.Weyl"><code>Weyl</code></a>, which produces expressions corresponding to  the <a href="https://en.wikipedia.org/wiki/Wigner%E2%80%93Weyl_transform#The_inverse_map">Weyl symbols</a> of quantum observables.   Note: <code>observable</code> can also be an array of observables, in which case an array is returned for each time.</li><li><code>ts</code> should be a sorted array of times.</li><li><code>N</code> is the number of points to sample. The bigger the more accurate.</li><li><code>distribution</code> should be an instance of <a href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>PhaseSpaceDistribution</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L294-L324">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.mcs_for_distributions-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.mcs_for_distributions-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.mcs_for_distributions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function mcs_for_distributions(system::ClassicalSystems.ClassicalSystem;
    x,
    xs::Union{AbstractRange{&lt;:Real},Nothing}=nothing,
    y=nothing,
    ts::Union{AbstractRange{&lt;:Real},Nothing}=nothing,
    animate::Bool=false,
    ys::Union{AbstractRange{&lt;:Real},Nothing}=nothing,
    N::Integer,
    distribution::PhaseSpaceDistribution)</code></pre><p>Generates a <a href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>MonteCarloSystem</code></a> that produces a multidimensional histogram allowing to visualize the expected value of observables under <a href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>PhaseSpaceDistribution</code></a> <code>distribution</code>.</p><p>Several behaviors can be produced.</p><ul><li>If <code>x</code> is <code>:t</code>, a matrix of dimensions <code>length(ts)</code> <span>$\times$</span> <code>length(ys)</code>  is produced. The coordinate <code>(tᵢ,yⱼ)</code> gives the probability of finding the observable <code>y</code> between <code>ys[j]</code> and <code>ys[j+1]</code> at the time <code>ts[i]</code>.</li><li>If <code>y</code> is <code>:t</code>, the same as above, changing <code>x</code> by <code>y</code>.</li><li>If neither <code>x</code> nor <code>y</code> are <code>:t</code>, and <code>animate = false</code>, then a matrix of dimensions <code>length(xs)</code> <span>$\times$</span> <code>length(ys)</code>  is produced.  The coordinate <code>(xᵢ,yⱼ)</code> gives the probability of finding the observable <code>x</code> between <code>xs[i]</code> and <code>xs[i+1]</code> and the observable <code>y</code> between <code>ys[j]</code> and <code>ys[j+1]</code>, averaging over all the times in <code>ts</code></li><li>If neither <code>x</code> nor <code>y</code> are <code>t</code>, and <code>animate = true</code> then an array of matrices of dimensions <code>length(xs)</code> <span>$\times$</span> <code>length(ys)</code>  is produced, the same size as <code>ts</code>. For the <code>n</code>th matrix in this array, the coordinate <code>(xᵢ,yⱼ)</code> gives the probability of finding the observable <code>x</code> between <code>xs[i]</code> and <code>xs[i+1]</code> and the observable <code>y</code> between <code>ys[j]</code> and <code>ys[j+1]</code> at time <code>ts[n]</code>.</li></ul><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalSystems/#Dicke.ClassicalSystems.ClassicalSystem"><code>ClassicalSystems.ClassicalSystem</code></a>,</li><li><code>x</code> and <code>y</code> can be <code>:t</code>, or an observable as described in the arguments of <a href="#Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_averaging</code></a>.</li><li><code>xs</code> and <code>ys</code> should be given if  <code>x</code> and  <code>y</code> are not  <code>:t</code>, in wich case they should be range objects (e.g. <code>0:0.1:1</code>) containing the bins for the histogram.</li><li><code>ts</code> should be a range object (e.g. <code>0:0.1:1</code>) of times.</li><li><code>animate</code> should be a <code>Bool</code>, which determines the behavior if neither <code>x</code> nor <code>y</code> are <code>t</code>. Defaults to <code>true</code></li><li><code>N</code> is the number of points to sample. The bigger the more accurate.</li><li><code>distribution</code> should be an instance of <a href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>PhaseSpaceDistribution</code></a></li></ul><p>Note: If <code>ts</code> and <code>y</code> are both not passed, then <code>y</code> is set to <code>:t</code> and <code>ts</code> to <code>0:0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L360-L400">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.mcs_for_survival_probability-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.mcs_for_survival_probability-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.mcs_for_survival_probability</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function mcs_for_survival_probability(
    system::ClassicalSystems.ClassicalSystem;
    N::Integer,
    ts::AbstractArray{&lt;:Real},
    distribution::PhaseSpaceDistribution)</code></pre><p>Generates a <a href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>MonteCarloSystem</code></a> that computes the survival probability through Eq. (C.7) of Ref. <a href="../references/#Villasenor2020">[9]</a> (with <span>$M=$</span> <code>N</code>, <span>$w=$</span> <code>distribution</code>).</p><p><strong>Arguments</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalSystems/#Dicke.ClassicalSystems.ClassicalSystem"><code>ClassicalSystems.ClassicalSystem</code></a>,</li><li><code>ts</code> should be a sorted array of times.</li><li><code>N</code> is the number of points to sample. The bigger the more accurate.</li><li><code>distribution</code> should be an instance of <a href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>PhaseSpaceDistribution</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L622-L638">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.mcs_for_variance-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.mcs_for_variance-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.mcs_for_variance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function mcs_for_variance(
    system::ClassicalSystems.ClassicalSystem;
    observable,
    ts::AbstractVector{&lt;:Real}=[0.0],
    N::Integer,
    distribution::PhaseSpaceDistribution,
    return_average::Bool = false)</code></pre><p>Generates a <a href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>MonteCarloSystem</code></a> that computes the variance</p><p class="math-container">\[    \frac{1}{N} \sum_{i=1}^N \text{observable}^2(\mathbf{x}_i(t)) - \left (\frac{1}{N}\sum_{i=1}^N \text{observable}(\mathbf{x}_i(t))\right )^2\]</p><p>for each <span>$t$</span> in <code>ts</code>, where <span>$\mathbf{x}_i$</span> will be sampled from <code>distribution</code>. The system produces an array the same size as <code>ts</code>, containing the result for each time.</p><p><strong>Arguments</strong></p><ul><li>See arguments for <a href="#Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_averaging</code></a>.</li><li>If <code>return_average=false</code> (default), only produces the variance, else it  will produce a tuple, where the first element is the variance and the second the average.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L557-L579">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}" href="#Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}"><code>Dicke.TruncatedWignerApproximation.monte_carlo_integrate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function monte_carlo_integrate(system::ClassicalSystems.ClassicalSystem,
    mc_system::MonteCarloSystem;
    tolerate_errors=true,
    maxNBatch=Inf,kargs...)</code></pre><p>This function is the backbone of this module. It performs a Monte Carlo integration-type procedure. The argument <code>mc_system</code> determines a <code>distribution::</code><a href="#Dicke.TruncatedWignerApproximation.PhaseSpaceDistribution"><code>PhaseSpaceDistribution</code></a>, an integer <code>N</code>, and a list of times <code>ts</code>. This function calls an initializing function also determined by <code>mc_system</code>. Then, it samples <code>N</code> random points <code>x</code> from <code>distribution</code>, which are integrated using the Hamiltonian given by <code>system</code>. For each trajectory and time in <code>ts</code>, an operation is performed, which is determined again by <code>mc_system</code>. A final operation is then performed and the result is returned. This may seem a bit abstract, but it is a very flexible system. The applications are more concrete; for example, if you generate <code>mc_system</code> using <a href="#Dicke.TruncatedWignerApproximation.mcs_for_averaging-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_averaging(... observable=f ...)</code></a>,  then the initial operation is to generate an array of zeroes the same length as <code>ts</code>. Then, for each initial condition <code>x</code>, the result of <code>f(x(t))</code> is added to each element of the array. Finally, the array is overall divided by <code>N</code> and then returned. This is exactly a Monte Carlo integration of the function <code>f(x)</code> over the classical evolution  of the distribution.</p><p>This function uses all the available workers, but make sure to import this module in all of them.</p><p><strong>Arguments:</strong></p><ul><li><code>system</code> should be an instance of <a href="../ClassicalSystems/#Dicke.ClassicalSystems.ClassicalSystem"><code>ClassicalSystems.ClassicalSystem</code></a>.</li><li><code>mc_system</code> should be an instance of  <a href="#Dicke.TruncatedWignerApproximation.MonteCarloSystem"><code>MonteCarloSystem</code></a>.</li><li><code>tolerate_errors</code> indicates that some errors in the integration may be ignored. This is useful because sometimes a one-in-a-million numerical instability may arise, and you may want to ignore it. If more than <code>100</code> errors occur consecutively, then then the procedure is stopped. Defaults to <code>true</code>.</li><li><code>maxNBatch</code> is the maximum number of batch-sizes sent to each worker. Defaults to <code>inf</code>.</li><li><code>kargs</code> are redirected to [<code>ClassicalSystems.integrate</code>].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L64-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.survival_probability-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.survival_probability-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.survival_probability</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function survival_probability(system::ClassicalSystems.ClassicalSystem, 
    [[[same kargs as mcs_for_survival_probability]]],
    kargs...)</code></pre><p>Calls <a href="#Dicke.TruncatedWignerApproximation.mcs_for_survival_probability-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_survival_probability</code></a> and then <a href="#Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}"><code>monte_carlo_integrate</code></a> on the resulting <code>MonteCarloSystem</code>. Extra <code>kargs</code> are sent to the latter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L656-L663">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.variance-Tuple{Dicke.ClassicalSystems.ClassicalSystem}" href="#Dicke.TruncatedWignerApproximation.variance-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>Dicke.TruncatedWignerApproximation.variance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function variance(system::ClassicalSystems.ClassicalSystem, 
    [[[same kargs as mcs_for_variance]]],
    kargs...)</code></pre><p>Calls <a href="#Dicke.TruncatedWignerApproximation.mcs_for_variance-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>mcs_for_variance</code></a> and then <a href="#Dicke.TruncatedWignerApproximation.monte_carlo_integrate-Tuple{Dicke.ClassicalSystems.ClassicalSystem, Dicke.TruncatedWignerApproximation.MonteCarloSystem}"><code>monte_carlo_integrate</code></a> on the resulting <code>MonteCarloSystem</code>. Extra <code>kargs</code> are sent to the latter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L610-L617">source</a></section></article><h2 id="Dicke.TruncatedWignerApproximation.Weyl"><a class="docs-heading-anchor" href="#Dicke.TruncatedWignerApproximation.Weyl">Weyl symbols</a><a id="Dicke.TruncatedWignerApproximation.Weyl-1"></a><a class="docs-heading-anchor-permalink" href="#Dicke.TruncatedWignerApproximation.Weyl" title="Permalink"></a></h2><p>The submodule <code>TruncatedWignerApproximation.Weyl</code> generates classical phase-space observables that may be passed as the argument <code>observable</code> of <a href="#Dicke.TruncatedWignerApproximation.average-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>average</code></a>, <a href="#Dicke.TruncatedWignerApproximation.calculate_distribution-Tuple{Dicke.ClassicalSystems.ClassicalSystem}"><code>calculate_distribution</code></a>, etc. All the following functions <a href="https://juliahub.com/docs/SymEngine">SymEngine</a> objects, so they may be operated as if they were numbers. </p><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.Jx-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.Jx-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.Jx</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function Jx(j::Real)</code></pre><p>Returns the Weyl symbol of the operator <span>$\hat{J}_x$</span>. (See p. 114 of Ref. <a href="../references/#Varilly1989">[8]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L821-L826">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.Jx²-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.Jx²-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.Jx²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function Jx²(j::Real)</code></pre><p>Returns the Weyl symbol of the operator <span>$\hat{J}_x^2$</span>. (See bottom of p. 128 of Ref. <a href="../references/#Varilly1989">[8]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L849-L854">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.Jy-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.Jy-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.Jy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function Jy(j::Real)</code></pre><p>Returns the Weyl symbol of the operator <span>$\hat{J}_y$</span>. (See p. 114 of Ref. <a href="../references/#Varilly1989">[8]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L830-L835">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.Jy²-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.Jy²-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.Jy²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function Jy²(j::Real)</code></pre><p>Returns the Weyl symbol of the operator <span>$\hat{J}_y^2$</span>. (See bottom of p. 128 of Ref. <a href="../references/#Varilly1989">[8]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L859-L864">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.Jz-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.Jz-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.Jz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function Jz(j::Real)</code></pre><p>Returns the Weyl symbol of the operator <span>$\hat{J}_z$</span>. (See p. 114 of Ref. <a href="../references/#Varilly1989">[8]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L812-L817">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.Jz²-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.Jz²-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.Jz²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function Jz²(j::Real)</code></pre><p>Returns the Weyl symbol of the operator <span>$\hat{J}_z^2$</span>. (See bottom of p. 128 of Ref. <a href="../references/#Varilly1989">[8]</a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L839-L844">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.n-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.n-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.n</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function n(j::Real)</code></pre><p>Returns the Weyl symbol of the number operator <span>$W(n̂)$</span>, <code>(p²+  q² - ħ)/2</code>, where <code>ħ = 1/j</code>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L777-L782">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Dicke.TruncatedWignerApproximation.Weyl.n²-Tuple{Real}" href="#Dicke.TruncatedWignerApproximation.Weyl.n²-Tuple{Real}"><code>Dicke.TruncatedWignerApproximation.Weyl.n²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">function n²(j::Real)</code></pre><p>Returns the Weyl symbol of the number operator squared <span>$W(n̂^2) = W(n̂)^2 - \hbar^2/4$</span>, where <span>$\hbar = 1/j$</span>. (Note that the extra term <span>$\hbar^2/4$</span>  appears due to the non-commutativity of <span>$q̂$</span> and <span>$p̂$</span>. See Ref. <a href="../references/#Polkovnikov2013">[7]</a> for details on how to compute these expressions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/saulpila/Dicke.jl/blob/6b5699ced1b1ea910214cb24b5a403ddfff6fd3b/src/TruncatedWignerApproximation.jl#L787-L793">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../UPOS/">« UPOS</a><a class="docs-footer-nextpage" href="../DickeHusimiProjections/">DickeHusimiProjections »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Sunday 4 July 2021 05:55">Sunday 4 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
